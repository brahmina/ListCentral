var ListHasImages=0;var ListHasLinks=0;var spinner="/images/"+themeID+"/LCSpinner.gif";var LCAvatar="";function validateEditList(e){var a=document.getElementById("ListName").value;if(a==""){alert("There  list's name cannot be blank");document.getElementById("ListName").focus();return false}var b=document.getElementById("Images");if(ListHasImages==1&&b.options[b.selectedIndex].value==0){var c=confirm("All of the images you have associated with this list will be lost! Are you sure that you want to remove images from this list?");return c}var d=document.getElementById("Links");if((ListHasLinks==1||ListHasLinks==2)&&d.options[d.selectedIndex].value==0){var c=confirm("All of the links you have associated with this list will be lost! Are you sure that you want to remove links from this list?");return c}return true}function getEditListItemFormContent(d,j,g,c,k){DynamicFormID=DynamicFormID+1;var b=document.getElementById("ListItem"+d+"Span").innerHTML;b=b.replace(/'/g,"&#39;");var e=getStatusOptions(g);var h="<form method='post' id='EditListItem"+d+"'><div class='FloatingDivTop'><div class='FloatingDivBottom'><div class='FloatingDiv' id='EditListItem'>         <h3>Edit List Item Details</h3>         <input type='hidden' name='todo' value='ListsManager.EditListItemDetails' id='todo"+DynamicFormID+"'>         <input type='hidden' name='ListItem.ID' value='"+d+"' id='ListItemID"+DynamicFormID+"'>         <input type='hidden' name='ListDivDisplay' id='ListDivDisplay"+DynamicFormID+"' value='ListEditView'>         <label>Name:</label><input type='text' name='ListItem.Name' id='Name"+DynamicFormID+"' value='"+b+"' class='TextInput' />         <label>Status:</label>"+e;if(j!=""){if(j=="1"){j=""}h=h+"         <label>Link:</label><input type='text' name='ListItem.Link' id='Link"+DynamicFormID+"' value='"+j+"' class='TextInput' />"}if(c!=""){var a='javascript:openWindow("upload_image.html?Edit=1&DynamicFormID='+DynamicFormID+'", "UploadImage", "height=486,width=430,status=yes,toolbar=no,scrollbars=yes");';if(c=="0"){h=h+"<div id='EditImageFormElement'>    <div id='EditImageForm"+DynamicFormID+"' style='display:block'>        <label for='edituploadimagesubmit' id='EditImageLabel'>Upload an Image:</label>            <input type='button' name='OpenFileUploader' value='Upload Image' id='edituploadimagesubmit' class='Button' onclick='"+a+"' />    </div>    <div id='EditImageImage"+DynamicFormID+"' style='display:none'>        <input type='hidden' name='ListItem.ImageID' id='EditUploadedImageID"+DynamicFormID+"' value='' />        <label for=''EditUploadedImage2>Image:</label><img src='' id='EditUploadedImage2"+DynamicFormID+"' class='EditUploadedImage2' />        <a href='javascript:cancelImageUploaded(1)' id='RemoveEditImageLink'>Remove Image</a><br /><div class='clear'></div>    </div></div>"}else{h=h+"<div id='EditImageFormElement'>    <div id='EditImageForm"+DynamicFormID+"' style='display:none'>        <label for='edituploadimagesubmit' id='EditImageLabel'>Upload an Image:</label>            <input type='button' name='OpenFileUploader' value='Upload Image' id='edituploadimagesubmit' class='Button' onclick='"+a+"' />    </div>    <div id='EditImageImage"+DynamicFormID+"' style='display:block'>        <input type='hidden' name='ListItem.ImageID' id='EditUploadedImageID"+DynamicFormID+"' value='"+c+"' />        <label>Image:</label><img src='"+k+"' id='EditUploadedImage2"+DynamicFormID+"' class='EditUploadedImage2' />        <a href='javascript:cancelImageUploaded(1)' id='RemoveEditImageLink'>Remove Image</a><br /><div class='clear'></div>    </div></div>"}}var f="ListItem"+d+"DescriptionSpan";var l="";if(checkobject(f)){l=document.getElementById(f).innerHTML;l=l.replace(/<br>/g,"\n");l=l.replace(/^\s+/,"");if(l!=null){h=h+"         <label>Description:</label><textarea name='ListItem.Description' id='ListItemDescription"+DynamicFormID+"'>"+l+"</textarea>"}}else{h=h+"         <label>Description:</label><textarea name='ListItem.Description' id='ListItemDescription"+DynamicFormID+"'></textarea>"}h=h+"            <input type='button' name='Submit' value='Submit' id='editlistitemsubmit'"+DynamicFormID+"' class='Button' onClick='processDynamicForm(this.form)' />            <input type='button' name='Cancel' value='Cancel' id='editlistitemcancel'"+DynamicFormID+"' class='Button' onClick='doNothing()' /></div></div></div></form> ";var i=h;h="";return i}function doServerRequestOld(h,j){var a=false;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){}}}}if(!a){return false}a.onreadystatechange=function(){if(a.readyState==4){processContents(a,j)}};if(j!=""){var d=getSpinnerContent(j,spinner);var b=document.getElementById(j);b.style.display="";b.innerHTML=d}var c=h.split("?");h=c[0];var f=c[1];a.open("POST",h,true);var i="application/x-www-form-urlencoded; charset=iso-8859-1";a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(f)}function processContents(f,c){if(f.readyState==4){try{if(f.status==200){var a=f.responseText;if(c!=""){var b=document.getElementById(c);b.innerHTML=a;launchJavascript(a)}}else{alert("There was a problem with the request, http status (1): "+f.status+", responseText: "+f.responseText)}}catch(d){if(f.status==200){var a=f.responseText;if(c!=""){var b=document.getElementById(c);b.innerHTML=a;launchJavascript(a)}}else{alert("There was a problem with the request, http status(2) : "+f.status)}}}else{alert("ready state failure, ready state: "+f.readyState)}}function doServerRequestWithFunc(j,f,d){var a=false;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}}}if(!a){return false}a.onreadystatechange=function(){if(a.readyState==4){processContents(a,f);if(d!=""){d()}}};if(f!=""){var b=document.getElementById(f);b.style.display="";var g=getSpinnerContent(f,spinner);b.innerHTML=g}var c=j.split("?");j=c[0];var h=c[1];a.open("POST",j,true);var k="application/x-www-form-urlencoded; charset=iso-8859-1";a.setRequestHeader("Content-Type",k);a.send(h)}var variable=0;function doServerRequestReturnToJS(a,d,b){var f=false;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{if(window.ActiveXObject){try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{f=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}}if(!f){return false}f.onreadystatechange=function(){if(f.readyState==4){var e=f.responseText;variable=e;b()}};f.open("POST",a,true);f.send(d)}function launchJavascript(responseText){var js="";var ScriptFragment="(?:<script.*?>)((\n|.)*?)(?:<\/script.*?>)";var match=new RegExp(ScriptFragment,"img");var scripts=responseText.match(match);if(scripts){var js="";for(var s=0;s<scripts.length;s++){var match=new RegExp(ScriptFragment,"im");js+=scripts[s].match(match)[1]}js=js.replace(/<!--/g,"").replace(/\/\/-->/g,"");eval(js)}}function SwitchToEditMode(b,a){if(b==1){document.getElementById("ListNormalView").style.display="none";document.getElementById("ListReorderView").style.display="none";document.getElementById("ListEditView").style.display="";document.getElementById("ListDivDisplay").value="ListEditView"}else{document.getElementById("ListDivDisplay").value="ListNormalView";if(listChanged){listChanged=0;loadList(a)}else{document.getElementById("ListNormalView").style.display="";document.getElementById("ListReorderView").style.display="none";document.getElementById("ListEditView").style.display="none"}}};